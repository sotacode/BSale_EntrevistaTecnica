(()=>{"use strict";const e=async(e="")=>{let t,n;try{if(""==e?(t="https://bsaletest-apirest.herokuapp.com/api/products/",n=await fetch(t)):(t="https://bsaletest-apirest.herokuapp.com/api/productsFiltered/",n=await fetch(t+e)),!n.ok)throw alert("No se pudo realizar la peticion");return await n.json()}catch(e){throw e}},t=[],n=document.querySelector("#inputSearch"),c=document.querySelector("#select"),a=e=>{document.querySelector("#content").innerHTML="";const t=document.querySelector("#content");r.map((e=>{const n=document.getElementById(e[1].toString());null!=n&&n.checked&&t.appendChild(e[0])})),""==t.innerHTML&&r.map((e=>{t.appendChild(e[0])}))},o=(e,t)=>{e=e[0],t=t[0];let n,a=e.innerText.split(/\$/)[1],o=e.innerText.split(/\$/)[2];n=a.includes("Comprar")?Number(a.split("C")[0]):Number(o.split("C")[0]);let r,d=t.innerText.split(/\$/)[1],l=t.innerText.split(/\$/)[2];return r=d.includes("Comprar")?Number(d.split("C")[0]):Number(l.split("C")[0]),"mayor"==c.value?n<r?1:n>r?-1:0:"menor"==c.value?n>r?1:n<r?-1:0:0};let r;const d=e=>{document.querySelector("#content").removeChild(document.getElementById("cargando")),r=[],e.map((e=>{const t=document.createElement("div");t.className="card";const n=document.createElement("img");n.src=e.url_image,t.appendChild(n);const c=document.createElement("h2");c.textContent=e.name,t.appendChild(c);const a=document.createElement("div");a.className="prices";const o=document.createElement("p");if(o.textContent="$"+e.price,o.className="priceorigin",a.appendChild(o),t.setAttribute("data-value",e.price),0!=e.discount){const n=document.createElement("p");n.className="priceDiscounted",n.textContent="$"+(e.price-e.price*e.discount/100),a.appendChild(n),o.className+=o.className+" underlineAdd",t.nodeValue=(e.price-e.price*e.discount/100).toString();const c=document.createElement("span");c.textContent=e.discount+"% dcto",t.appendChild(c)}t.appendChild(a);const d=document.createElement("div");d.className="buttons";const l=document.createElement("button");l.className="buttonBuy",l.textContent="Comprar",d.appendChild(l);const i=document.createElement("button");i.className="buttonAddToCart",i.textContent="Agregar al carro",d.appendChild(i),t.appendChild(d),r.push([t,e.category])})),r.sort(o);const t=document.querySelector("#content");r.map((e=>{t.appendChild(e[0])}))};buttonSearch.addEventListener("click",(()=>{document.querySelector("#content").innerHTML="",document.querySelector("#content").innerHTML="<h1 id='cargando'> Cargando productos </h1>",e(n.value.toLowerCase()).then((e=>{d(e),(e=>{let n=[];e.map((e=>{n.includes(e.category)||t.map((t=>{t.id!=e.category||n.includes(t)||n.push(t)}))}));const c=document.querySelector("#lateral"),o=document.querySelector(".filtercategory");o.innerHTML="",n.map((e=>{const t=document.createElement("div");t.className="container";const n=document.createElement("input");n.type="checkbox",n.name="categoria",n.value=e.name,n.id=e.id.toString(),n.onchange=a;var c=document.createElement("label");c.htmlFor="id",c.innerText=e.name,t.appendChild(n),t.appendChild(c),o.appendChild(t)})),c.appendChild(o)})(e)}))}));document.body.style.backgroundImage="url(./assets/img/pattern.png)",document.querySelector("#content").innerHTML="<h1 id='cargando'> Cargando productos </h1>",c.onchange=e=>{document.querySelector("#content").innerHTML="",r.sort(o);const t=document.querySelector("#content");r.map((e=>{t.appendChild(e[0])}))},n.onkeypress=function(e){var t;13!==(t=e).keyCode||t.shiftKey||(t.preventDefault(),buttonSearch.click())},e(n.value.toLowerCase()).then((e=>{d(e)})),(async()=>{try{const e="http://localhost:3000/api/categorys/",t=await fetch(e);if(!t.ok)throw alert("No se pudo realizar la peticion");return await t.json()}catch(e){throw e}})().then((e=>{(e=>{const n=document.querySelector("#lateral"),c=document.createElement("h3");c.innerText="Categorias",n.appendChild(c);const o=document.createElement("div");o.className="filtercategory",e.map((e=>{const n=document.createElement("div");t.push(e);const c=document.createElement("input");c.type="checkbox",c.name="categoria",c.value=e.name,c.id=e.id.toString(),c.onchange=a;var r=document.createElement("label");r.htmlFor="id",r.innerText=e.name,n.appendChild(c),n.appendChild(r),o.appendChild(n)})),n.appendChild(o)})(e)}))})();